(function(a){var b=function(e,d){var g=/^(.*)(\d)+$/i;var f=a(e);var h={limit:999,cloneThis:".toclone",valueClone:false,dataClone:false,deepClone:false,cloneButton:".clone",deleteButton:".delete",clonePosition:"after",serializeID:true,};var c=a.extend(h,d||{});this.getOption=function(){return c};this.setOption=function(k){a.extend(c,k||{})};if(f.find(c.cloneButton).length){f.on("click",c.cloneButton,function(k){k.preventDefault();f.triggerHandler("clone_clone",[a(this)])})}f.on("clone_clone",function(l,m){var k=f.find(c.cloneThis).length;if(k<c.limit){$toclone=m.closest(c.cloneThis);f.triggerHandler("clone_before_clone",[$toclone]);$newclone=$toclone.clone({withDataAndEvents:c.dataClone,deepWithDataAndEvents:c.deepClone});$newclone.find("input, textarea, select").each(function(){if(!c.valueClone){a(this).val("")}f.triggerHandler("clone_form_input",[a(this),$toclone,$newclone])});f.triggerHandler("clone_after_clone",[$toclone,$newclone]);f.triggerHandler("clone_before_append",[$toclone,$newclone]);if(c.clonePosition!="after"){$toclone.before($newclone)}else{$toclone.after($newclone)}i();f.triggerHandler("clone_after_append",[$toclone,$newclone])}else{f.triggerHandler("clone_limit",c.limit,[$toclone])}});if(f.find(c.cloneButton).length){f.on("click",c.deleteButton,function(k){k.preventDefault();f.triggerHandler("clone_delete",[a(this)])})}f.on("clone_delete",function(l,m){var k=f.find(c.cloneThis).length;if(k>1){$todelete=m.closest(c.cloneThis);a.when(f.triggerHandler("clone_before_delete",[$todelete])).done(function(){f.triggerHandler("clone_after_delete")})}});f.on("clone_before_delete",function(l,k){a(k).remove()});var i=function(){if(c.serializeID!==true){return}mainid=f.find(c.cloneThis).first().attr("id");f.find(c.cloneThis).each(function(k){if(k!==0){j=k}else{j=""}if(a(this).attr("id")){a(this).attr("id",mainid+j)}a(this).find("*").each(function(){var p=a(this).attr("id");if(p){var n=p.match(g);if(n&&n.length===3){a(this).attr("id",n[1]+j)}else{a(this).attr("id",p+j)}}var m=a(this).attr("name");if(m){var o=m.match(/\[([^}]+)\]/);if(o&&o.length>=1){var l=m;m=[].map.call(l,function(r,q){return(!isNaN(+r)&&l[q-1]==="["&&l[q+1]==="]")?q:r}).join("");a(this).attr("name",m)}}})})}};a.fn.cloneya=function(c){return this.each(function(){var d=a(this);if(d.data("cloneya")){return}var e=new b(this,c);d.data("cloneya",e)})}})(jQuery);